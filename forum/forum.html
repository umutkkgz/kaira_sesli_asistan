<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaira Forumları</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        .view {
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        .modal-backdrop {
            transition: opacity 0.3s ease-in-out;
        }
        .modal-content {
            transition: transform 0.3s ease-in-out;
        }
        /* Aktif kategori için stil */
        .category-item.active {
            background-color: #eef2ff;
            color: #4f46e5;
            font-weight: 600;
        }
        /* Prose stillerini daha modern hale getirelim */
        .prose code {
            background-color: #e5e7eb;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        .prose pre {
            background-color: #1f2937;
            color: #d1d5db;
            padding: 1em;
            border-radius: 0.5em;
            overflow-x: auto;
        }
        .prose blockquote {
            border-left-color: #4f46e5;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- ANA KONTEYNER -->
    <div class="container mx-auto p-4 md:p-6 lg:p-8 max-w-8xl">

        <!-- HEADER -->
        <header class="bg-white rounded-xl shadow-md p-4 mb-6 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2V4a2 2 0 012-2h6.172a2 2 0 011.414.586l3.828 3.828A2 2 0 0117 8z"></path></svg>
                <h1 class="text-xl md:text-2xl font-bold text-gray-900">Kaira Forumları</h1>
            </div>
            <div class="flex items-center space-x-4">
                <button id="open-new-thread-modal-btn" class="bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition-transform transform hover:scale-105 flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                    <span class="hidden md:block">Yeni Konu Aç</span>
                </button>
                <!-- Bildirimler -->
                 <div class="relative">
                    <svg class="w-7 h-7 text-gray-500 hover:text-gray-800 cursor-pointer" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>
                    <span class="absolute top-0 right-0 block h-2 w-2 rounded-full bg-red-500 ring-2 ring-white"></span>
                </div>
                <!-- Kullanıcı Avatarı -->
                <img src="https://placehold.co/40x40/7c3aed/ffffff?text=U" alt="Kullanıcı Avatarı" class="w-10 h-10 rounded-full cursor-pointer">
            </div>
        </header>

        <div class="grid grid-cols-12 gap-6">
            <!-- SOL KENAR ÇUBUĞU - KATEGORİLER -->
            <aside class="col-span-12 md:col-span-3">
                <div class="bg-white rounded-xl shadow-md p-4">
                    <h3 class="font-bold text-lg mb-4">Kategoriler</h3>
                    <ul id="categories-list" class="space-y-2">
                        <!-- Kategoriler JS ile dinamik olarak yüklenecek -->
                    </ul>
                </div>
            </aside>

            <!-- ANA İÇERİK ALANI -->
            <div class="col-span-12 md:col-span-9">
                <!-- ============================================= -->
                <!-- ===== FORUM LİSTE GÖRÜNÜMÜ (ANA SAYFA) ===== -->
                <!-- ============================================= -->
                <main id="forum-list-view" class="view">
                    <!-- ARAMA VE FİLTRELEME -->
                    <div class="bg-white rounded-xl shadow-md p-4 mb-4">
                         <div class="flex flex-col md:flex-row gap-4">
                             <div class="relative flex-grow">
                                 <input type="text" placeholder="Forumda ara..." class="w-full p-3 pl-10 bg-gray-100 border border-transparent rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                 <svg class="w-5 h-5 text-gray-400 absolute top-1/2 left-3 transform -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                             </div>
                             <select class="p-3 bg-gray-100 border border-transparent rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                                 <option>En Yeni</option>
                                 <option>En Popüler</option>
                                 <option>En Çok Yanıtlanan</option>
                             </select>
                         </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-md">
                        <div class="p-4 border-b border-gray-200">
                            <h2 id="list-title" class="text-lg font-semibold">Son Tartışmalar</h2>
                        </div>
                        <div id="threads-container" class="divide-y divide-gray-200">
                            <!-- Konular JS ile dinamik olarak buraya yüklenecek -->
                        </div>
                    </div>
                    <!-- SAYFALAMA -->
                     <div class="mt-6 flex justify-center items-center space-x-2">
                        <button class="px-4 py-2 bg-white rounded-md shadow-sm text-gray-600 hover:bg-gray-50">&laquo; Önceki</button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-md shadow-sm">1</button>
                        <button class="px-4 py-2 bg-white rounded-md shadow-sm text-gray-600 hover:bg-gray-50">2</button>
                        <button class="px-4 py-2 bg-white rounded-md shadow-sm text-gray-600 hover:bg-gray-50">3</button>
                        <button class="px-4 py-2 bg-white rounded-md shadow-sm text-gray-600 hover:bg-gray-50">Sonraki &raquo;</button>
                    </div>
                </main>

                <!-- ======================================= -->
                <!-- ===== KONU DETAY GÖRÜNÜMÜ (GİZLİ) ===== -->
                <!-- ======================================= -->
                <main id="thread-detail-view" class="view hidden opacity-0">
                    <div class="mb-4">
                        <button id="back-to-list-btn" class="text-indigo-600 hover:text-indigo-800 font-semibold flex items-center space-x-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                            <span id="back-to-list-text">Tüm Konulara Geri Dön</span>
                        </button>
                    </div>
                    
                    <div id="thread-detail-content">
                        <!-- Konu detayı JS ile dinamik olarak buraya yüklenecek -->
                    </div>
                </main>
            </div>
        </div>
    </div>

    <!-- =================================================== -->
    <!-- ===== YENİ KONU OLUŞTURMA MODALI (PENCERE) ===== -->
    <!-- =================================================== -->
    <div id="new-thread-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden modal-backdrop">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl p-8 transform scale-95 modal-content">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Yeni Bir Konu Başlat</h2>
                <button id="close-modal-btn" class="text-gray-400 hover:text-gray-700 text-3xl">&times;</button>
            </div>
            <form id="new-thread-form">
                <div class="mb-4">
                    <label for="thread-title" class="block text-sm font-medium text-gray-700 mb-1">Konu Başlığı</label>
                    <input type="text" id="thread-title" class="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="Konunuzu özetleyen bir başlık girin..." required>
                </div>
                 <div class="mb-4">
                    <label for="thread-category" class="block text-sm font-medium text-gray-700 mb-1">Kategori</label>
                    <select id="thread-category" class="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" required>
                        <!-- Kategoriler JS ile yüklenecek -->
                    </select>
                </div>
                <div class="mb-6">
                    <label for="thread-message" class="block text-sm font-medium text-gray-700 mb-1">Mesajınız</label>
                    <!-- Sahte Zengin Metin Editörü Araç Çubuğu -->
                    <div class="border border-gray-300 rounded-t-lg bg-gray-50 p-2 flex space-x-2">
                        <button type="button" class="p-1 rounded hover:bg-gray-200">B</button>
                        <button type="button" class="p-1 rounded hover:bg-gray-200">I</button>
                        <button type="button" class="p-1 rounded hover:bg-gray-200">&lt;/&gt;</button>
                        <button type="button" class="p-1 rounded hover:bg-gray-200">Link</button>
                    </div>
                    <textarea id="thread-message" rows="8" class="w-full p-3 border-l border-r border-b border-gray-300 rounded-b-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="Detayları buraya yazın..." required></textarea>
                </div>
                <div class="text-right">
                    <button type="submit" class="w-full md:w-auto bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition">Konuyu Oluştur</button>
                </div>
            </form>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // ===================================
            // ===== STATE & MOCK DATA (VERİ) =====
            // ===================================

            const mockData = {
                users: {
                    'user-1': { name: 'Ali Veli', avatar: 'https://placehold.co/48x48/f87171/ffffff?text=A' },
                    'user-2': { name: 'Merve Yılmaz', avatar: 'https://placehold.co/48x48/34d399/ffffff?text=M' },
                    'user-3': { name: 'Selin Kaya', avatar: 'https://placehold.co/48x48/60a5fa/ffffff?text=S' },
                    'user-4': { name: 'Umut Kökgöz', avatar: 'https://placehold.co/48x48/7c3aed/ffffff?text=U', isDeveloper: true },
                    'user-5': { name: 'Can Boz', avatar: 'https://placehold.co/48x48/f59e0b/ffffff?text=C' },
                },
                categories: [
                    { id: 'all', name: 'Tüm Konular' },
                    { id: 'general', name: 'Genel Tartışma' },
                    { id: 'ai-editor', name: 'AI Editör' },
                    { id: 'code-lab', name: 'Kod Laboratuvarı' },
                    { id: 'assistant', name: 'Sesli Asistan' },
                    { id: 'bug-reports', name: 'Hata Bildirimleri' },
                ],
                threads: [
                    {
                        id: 1,
                        categoryId: 'ai-editor',
                        title: 'AI Editör için yeni özellik önerileri',
                        authorId: 'user-1',
                        timestamp: '2 saat önce',
                        views: 256,
                        content: `<p>Herkese selamlar,</p>
                            <p>Öncelikle bu harika proje için Umut'a teşekkürler. AI Editör'ü keyifle kullanıyorum ve aklıma birkaç fikir geldi. Bunları tartışmaya açmak istedim:</p>
                            <ul>
                                <li><strong>Katman Sistemi:</strong> Photoshop'taki gibi katmanlar ekleyebilsek ve her katmanda farklı bir yapay zeka işlemi yapabilsek harika olmaz mı?</li>
                                <li><strong>Maskeleme Aracı:</strong> Yapay zekanın sadece fotoğrafın belirli bir bölümünü (örneğin sadece gökyüzünü) değiştirmesini sağlamak için bir maskeleme aracı eklenebilir.</li>
                                <li><strong>Toplu İşlem:</strong> Birden fazla fotoğrafa aynı komutu uygulama özelliği çok zaman kazandırır.</li>
                            </ul>
                            <p>Siz ne düşüniyorsunuz? Başka ne gibi özellikler eklenebilir?</p>`,
                        replies: [
                            { authorId: 'user-2', timestamp: '1 saat önce', content: '<p>Katman sistemi fikri harika! Bu, aracı çok daha profesyonel bir seviyeye taşıyacaktır. Maskeleme de kesinlikle olmalı.</p>', likes: 15 },
                            { authorId: 'user-4', timestamp: '45 dakika önce', content: '<p>Harika öneriler için teşekkürler Ali! Bu fikirleri kesinlikle not aldım. Katman sistemi teknik olarak biraz zorlayıcı olabilir ama maskeleme aracı üzerinde çalışmaya başlayabilirim. Toplu işlem de yol haritasına eklendi!</p>', likes: 28 },
                            { authorId: 'user-5', timestamp: '10 dakika önce', content: '<p>Maskeleme aracını sabırsızlıkla bekliyorum. Bu özellik gelirse projelerimde sıkça kullanırım.</p>', likes: 7 },
                        ]
                    },
                    {
                        id: 2,
                        categoryId: 'code-lab',
                        title: 'Kod Laboratuvarı\'nda JavaScript projesi paylaştım',
                        authorId: 'user-2',
                        timestamp: '5 saat önce',
                        views: 102,
                        content: `<p>Basit bir oyun yazdım, kodlarını ve demosunu Kod Laboratuvarı üzerinden paylaşıyorum. Geri bildirimlerinizi bekliyorum.</p>
                                   <p>Oyunun amacı, ekranda rastgele beliren hedefleri vurmak. İşte kod bloğu:</p>
                                   <pre><code>function setup() {\n  createCanvas(400, 400);\n}\n\nfunction draw() {\n  background(220);\n  ellipse(50,50,80,80);\n}</code></pre>
                                   <p>Geliştirmeler için önerilere açığım!</p>`,
                        replies: [
                            { authorId: 'user-5', timestamp: '4 saat önce', content: '<p>Çok güzel bir başlangıç olmuş! Skor sistemi eklenebilir.</p>', likes: 5 },
                        ]
                    },
                    {
                        id: 3,
                        categoryId: 'assistant',
                        title: 'Sesli asistana nasıl yeni komutlar ekleyebiliriz?',
                        authorId: 'user-3',
                        timestamp: '1 gün önce',
                        views: 188,
                        content: `<p>Kaira'nın sesli asistanını kendi projeme entegre etmek istiyorum. Yeni komutlar tanımlamak için bir döküman veya örnek var mı acaba?</p>
                                   <blockquote>Bu konuda yardıma ihtiyacım var, şimdiden teşekkürler.</blockquote>`,
                        replies: [
                            { authorId: 'user-4', timestamp: '20 saat önce', content: '<p>Merhaba Selin, şu an için bu özellik dökümante edilmedi ama yakın zamanda bir rehber hazırlayacağım. Temel olarak `commands.js` dosyasını genişletmen gerekiyor.</p>', likes: 12 },
                            { authorId: 'user-3', timestamp: '19 saat önce', content: '<p>Teşekkürler Umut, rehberi bekliyor olacağım!</p>', likes: 2 },
                        ]
                    },
                ]
            };

            let currentCategory = 'all';

            // ===================================
            // ===== SELECTORS (ELEMENTLER) =====
            // ===================================
            
            const forumListView = document.getElementById('forum-list-view');
            const threadDetailView = document.getElementById('thread-detail-view');
            const newThreadModal = document.getElementById('new-thread-modal');
            const openModalBtn = document.getElementById('open-new-thread-modal-btn');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const backToListBtn = document.getElementById('back-to-list-btn');
            const categoriesList = document.getElementById('categories-list');
            const threadsContainer = document.getElementById('threads-container');
            const threadDetailContent = document.getElementById('thread-detail-content');
            const listTitle = document.getElementById('list-title');
            const backToListText = document.getElementById('back-to-list-text');
            const newThreadForm = document.getElementById('new-thread-form');
            const threadCategorySelect = document.getElementById('thread-category');
            

            // ===================================
            // ===== RENDER FUNCTIONS (ÇİZİM) =====
            // ===================================

            const renderCategories = () => {
                categoriesList.innerHTML = '';
                threadCategorySelect.innerHTML = '';
                mockData.categories.forEach(category => {
                    const li = document.createElement('li');
                    li.innerHTML = `<a href="#" class="block p-2 rounded-md hover:bg-gray-100 category-item ${category.id === currentCategory ? 'active' : ''}" data-category-id="${category.id}">${category.name}</a>`;
                    categoriesList.appendChild(li);

                    if (category.id !== 'all') {
                        const option = document.createElement('option');
                        option.value = category.id;
                        option.textContent = category.name;
                        threadCategorySelect.appendChild(option);
                    }
                });
            };

            const renderThreadList = () => {
                threadsContainer.innerHTML = '';
                const filteredThreads = currentCategory === 'all' 
                    ? mockData.threads 
                    : mockData.threads.filter(t => t.categoryId === currentCategory);

                if (filteredThreads.length === 0) {
                    threadsContainer.innerHTML = '<p class="p-4 text-center text-gray-500">Bu kategoride henüz konu yok.</p>';
                    return;
                }

                filteredThreads.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp)); // Placeholder sort

                filteredThreads.forEach(thread => {
                    const author = mockData.users[thread.authorId];
                    const threadHtml = `
                        <div class="thread-item p-4 flex items-start space-x-4 hover:bg-gray-50 cursor-pointer" data-thread-id="${thread.id}">
                            <img src="${author.avatar}" alt="Avatar" class="w-12 h-12 rounded-full flex-shrink-0">
                            <div class="flex-grow">
                                <h3 class="font-semibold text-gray-900">${thread.title}</h3>
                                <div class="text-xs text-gray-400 mt-2">
                                    <span>${author.name} tarafından</span> · <span class="font-medium">${thread.timestamp}</span>
                                </div>
                            </div>
                            <div class="text-right flex-shrink-0 w-24">
                                <div class="text-sm font-semibold">${thread.replies.length} Yanıt</div>
                                <div class="text-xs text-gray-500">${thread.views} Görüntülenme</div>
                            </div>
                        </div>`;
                    threadsContainer.innerHTML += threadHtml;
                });
            };
            
            const renderThreadDetail = (threadId) => {
                const thread = mockData.threads.find(t => t.id == threadId);
                if (!thread) return;

                const author = mockData.users[thread.authorId];
                
                let repliesHtml = thread.replies.map(reply => {
                    const replyAuthor = mockData.users[reply.authorId];
                    return `
                        <div class="bg-white rounded-xl shadow-sm p-5 flex space-x-4">
                            <img src="${replyAuthor.avatar}" alt="Avatar" class="w-10 h-10 rounded-full flex-shrink-0 mt-1">
                            <div class="flex-grow">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <span class="font-semibold ${replyAuthor.isDeveloper ? 'text-indigo-600' : ''}">${replyAuthor.name} ${replyAuthor.isDeveloper ? '(Geliştirici)' : ''}</span>
                                        <span class="text-sm text-gray-500">· ${reply.timestamp}</span>
                                    </div>
                                </div>
                                <div class="prose max-w-none mt-2 text-gray-700">${reply.content}</div>
                                <div class="mt-4 flex items-center space-x-4 text-sm text-gray-500">
                                    <button class="flex items-center space-x-1 hover:text-indigo-600"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 18.331V10h5M14 10V3a2 2 0 00-2-2l-1 5z"></path></svg> <span>${reply.likes} Beğen</span></button>
                                    <button class="flex items-center space-x-1 hover:text-indigo-600"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path></svg> <span>Yanıtla</span></button>
                                </div>
                            </div>
                        </div>`;
                }).join('');

                const detailHtml = `
                    <div class="bg-white rounded-xl shadow-md p-5">
                        <h2 class="text-2xl font-bold text-gray-900">${thread.title}</h2>
                        <div class="flex items-center space-x-3 mt-4 pb-4 border-b border-gray-200">
                            <img src="${author.avatar}" alt="Avatar" class="w-12 h-12 rounded-full">
                            <div>
                                <div class="font-semibold">${author.name}</div>
                                <div class="text-sm text-gray-500">${thread.timestamp} · Konu Sahibi</div>
                            </div>
                        </div>
                        <div class="prose max-w-none mt-4 text-gray-700">${thread.content}</div>
                    </div>

                    <div id="replies-container" class="mt-6 space-y-6">
                        <h3 class="text-xl font-semibold border-b pb-2">Yanıtlar (${thread.replies.length})</h3>
                        ${repliesHtml}
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-5 mt-6">
                        <h3 class="font-semibold mb-3">Yanıtınızı Yazın</h3>
                        <textarea id="reply-textarea" class="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" rows="5" placeholder="Düşüncelerinizi paylaşın..."></textarea>
                        <div class="text-right mt-3">
                            <button class="bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition">Yanıt Gönder</button>
                        </div>
                    </div>`;

                threadDetailContent.innerHTML = detailHtml;
            };

            // ===================================
            // ===== EVENT LISTENERS (OLAYLAR) =====
            // ===================================

            const showView = (viewToShow) => {
                forumListView.classList.add('hidden', 'opacity-0');
                threadDetailView.classList.add('hidden', 'opacity-0');
                
                viewToShow.classList.remove('hidden');
                setTimeout(() => viewToShow.classList.remove('opacity-0'), 10);
            };

            threadsContainer.addEventListener('click', (e) => {
                const threadItem = e.target.closest('.thread-item');
                if (threadItem) {
                    const threadId = threadItem.dataset.threadId;
                    const categoryName = mockData.categories.find(c => c.id === currentCategory).name;
                    backToListText.textContent = `${categoryName} Kategorisine Geri Dön`;
                    renderThreadDetail(threadId);
                    showView(threadDetailView);
                    window.scrollTo(0, 0);
                }
            });

            backToListBtn.addEventListener('click', () => {
                showView(forumListView);
            });

            categoriesList.addEventListener('click', (e) => {
                e.preventDefault();
                const categoryItem = e.target.closest('.category-item');
                if (categoryItem) {
                    currentCategory = categoryItem.dataset.categoryId;
                    const categoryName = mockData.categories.find(c => c.id === currentCategory).name;
                    listTitle.textContent = categoryName;
                    renderCategories();
                    renderThreadList();
                    showView(forumListView);
                }
            });

            const openModal = () => {
                newThreadModal.classList.remove('hidden');
                setTimeout(() => {
                    newThreadModal.classList.remove('opacity-0');
                    newThreadModal.querySelector('.modal-content').classList.remove('scale-95');
                }, 10);
            };

            const closeModal = () => {
                newThreadModal.classList.add('opacity-0');
                newThreadModal.querySelector('.modal-content').classList.add('scale-95');
                setTimeout(() => newThreadModal.classList.add('hidden'), 300);
            };

            openModalBtn.addEventListener('click', openModal);
            closeModalBtn.addEventListener('click', closeModal);
            newThreadModal.addEventListener('click', (e) => { if (e.target === newThreadModal) closeModal(); });
            document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && !newThreadModal.classList.contains('hidden')) closeModal(); });
            
            newThreadForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const newThread = {
                    id: mockData.threads.length + 1,
                    categoryId: newThreadForm['thread-category'].value,
                    title: newThreadForm['thread-title'].value,
                    authorId: 'user-4', // Simulating logged in user
                    timestamp: 'şimdi',
                    views: 0,
                    content: `<p>${newThreadForm['thread-message'].value.replace(/\n/g, '</p><p>')}</p>`,
                    replies: []
                };
                mockData.threads.unshift(newThread); // Add to the beginning
                currentCategory = newThread.categoryId;
                renderCategories();
                renderThreadList();
                showView(forumListView);
                closeModal();
                newThreadForm.reset();
            });

            // ===================================
            // ===== INITIALIZATION (BAŞLATMA) =====
            // ===================================
            
            const init = () => {
                renderCategories();
                renderThreadList();
            };

            init();
        });
    </script>
</body>
</html>

